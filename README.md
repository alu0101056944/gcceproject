# Project for the first part of the *Gestión de la Comunicación y Conocimiento Empresarial* subject

This project makes output tables from information obtained through web scraping different programming library sources. Right now it is able to gather the following information:

- Github repository development history.
- Downloads per week (npm, pip) of the corresponding github repository.
- Linkedin job posting mention amount of the corresponding github repository.
- reddit/r/programming mention amount of the corresponding github repository.
- employee amount, stock delta, budget estimations of each github repository's author (by assumming that it is an organization).
- Tool type (by tag checking) and specialization (by search term to find it) of the correspondding github repository.

Which allows knowing:
+ How well is the github repository's development going.
+ Relevance of the repository in the current market (linkedin, reddit.com/r/programming)
+ How is the author's trajectory evolving (in some cases).

It's meant to serve as a school project aimed at exploring business intelligence concepts. The project involves role-playing a consulting IT firm seeking to make informed decisions about tooling.

## Index

 1. [Requirements](#requirements)
 2. [Usage](#usage)
 3. [TODO](#todo)

## Requirements

A `GITHUB_TOKEN` environment variable must be set in a `.env` file.

## Usage

Execute:

`npm i`

Then:

`node index.mjs`

**It takes a while to finish execution (approximately 5 hours)**. Once finished the tables will be at `outputTables/`.

### Apache hop orchestration

The apache hop project is at `hop/gcce_project/` but all the workflows and pipelines used are at `hop/`. To start the orchestration start the `main_workflow.hwf` workflow but note that **configuration must be done beforehand**:

 - On each pipeline change the input csv file path to a path that contains the corresponding table. (the output tables, `outputTables/`, need to be converted to .csv manually for apache hop because there is nothing in this nodejs program to convert to csv).
 - On each dimension table pipeline set the path of the JSON Output to where it will be expected to store the local-id to global-id json files. I had it in a different folder than this project but ideally it should be here, so when looking into use it create a new folder for it here.
 - On each fact table pipeline there are JSON Input whose path must be set to the corresponding local id.-global id. .json files that was generated by the corresponding dimension pipelines.
 - On each pipeline a Table input node must be setup with the corresponding table from the database. This is the expected database schema (don't trusts [src\models\create_tables_raw.sql](src\models\create_tables_raw.sql) as it may not be updated to the latest schema that was used at the moment of finishing the assignment):

 |table_name          |column_name                 |data_type                  |
|--------------------|----------------------------|---------------------------|
|tool_project_company|company_id                  |integer                    |
|tool_project_company|tool_id                     |integer                    |
|tool_project_company|version                     |integer                    |
|tool_project_company|project_id                  |integer                    |
|tool_project_company|date_from                   |timestamp without time zone|
|tool_date           |date_id                     |integer                    |
|tool_date           |date_from                   |timestamp without time zone|
|tool_date           |versionrow                  |integer                    |
|tool_date           |tool_id                     |integer                    |
|tool_date           |interest_level              |integer                    |
|tool_date           |version                     |text                       |
|tool_date           |change_type                 |text                       |
|tool                |name                        |text                       |
|tool                |author_company              |text                       |
|tool                |date_from                   |timestamp without time zone|
|tool                |type                        |text                       |
|tool                |tool_id                     |integer                    |
|tool                |version                     |integer                    |
|tool                |specialization              |text                       |
|project_tool        |date_from                   |timestamp without time zone|
|project_tool        |project_id                  |integer                    |
|project_tool        |tool_id                     |integer                    |
|project_tool        |version                     |integer                    |
|project_company     |company_id                  |integer                    |
|project_company     |date_from                   |timestamp without time zone|
|project_company     |version                     |integer                    |
|project_company     |project_id                  |integer                    |
|project_company     |budget                      |numeric                    |
|project_company     |amount_of_employees_assigned|integer                    |
|project             |date_from                   |timestamp without time zone|
|project             |version                     |integer                    |
|project             |downloads                   |integer                    |
|project             |contributors                |integer                    |
|project             |project_id                  |integer                    |
|project             |searches                    |integer                    |
|project             |project_name                |text                       |
|market_tool_date    |date_from                   |timestamp without time zone|
|market_tool_date    |date_id                     |integer                    |
|market_tool_date    |market_id                   |integer                    |
|market_tool_date    |tool_id                     |integer                    |
|market_tool_date    |amount_of_mentions          |integer                    |
|market_tool_date    |version                     |integer                    |
|market_date         |market_id                   |integer                    |
|market_date         |date_id                     |integer                    |
|market_date         |version                     |integer                    |
|market_date         |total_amount_of_offers      |integer                    |
|market_date         |date_from                   |timestamp without time zone|
|market              |version                     |integer                    |
|market              |market_id                   |integer                    |
|market              |date_from                   |timestamp without time zone|
|employee_tool       |years_of_experience         |integer                    |
|employee_tool       |tool_id                     |integer                    |
|employee_tool       |date_from                   |timestamp without time zone|
|employee_tool       |employee_id                 |integer                    |
|employee_tool       |version                     |integer                    |
|employee            |department                  |text                       |
|employee            |employee_id                 |integer                    |
|employee            |version                     |integer                    |
|employee            |title                       |text                       |
|employee            |name                        |text                       |
|employee            |date_from                   |timestamp without time zone|
|date                |date                        |date                       |
|date                |date_id                     |integer                    |
|company_date        |company_id                  |integer                    |
|company_date        |version                     |integer                    |
|company_date        |date_from                   |timestamp without time zone|
|company_date        |benefit                     |numeric                    |
|company             |amount_of_searches          |integer                    |
|company             |name                        |text                       |
|company             |version                     |integer                    |
|company             |type                        |text                       |
|company             |date_from                   |timestamp without time zone|
|company             |employee_amount             |integer                    |
|company             |company_id                  |integer                    |
|community_tool_date |rank                        |integer                    |
|community_tool_date |date_from                   |timestamp without time zone|
|community_tool_date |tool_id                     |integer                    |
|community_tool_date |tool_score                  |integer                    |
|community_tool_date |community_id                |integer                    |
|community_tool_date |date_id                     |integer                    |
|community_tool_date |version                     |integer                    |
|community_tool      |amount_of_bugs_solved       |integer                    |
|community_tool      |date_from                   |timestamp without time zone|
|community_tool      |amount_of_bugs_reported     |integer                    |
|community_tool      |amount_of_changes_commited  |integer                    |
|community_tool      |community_id                |integer                    |
|community_tool      |tool_id                     |integer                    |
|community_tool      |version                     |integer                    |
|community_tool      |amount_of_discussions       |integer                    |
|community           |date_from                   |timestamp without time zone|
|community           |version                     |integer                    |
|community           |name                        |text                       |
|community           |community_id                |integer                    |
|community           |type                        |text                       |

 - When index.mjs finishes execution, the `todayDateTable.json` contains a different string date format than apache hop uses. So each time I executed it, after .csv convertion I had to change the `2024-01-08T00:00:00.000Z` format to `2024/01/08 00:00:00.000` in the .csv file for apache hop to execute correctly. So it must be manually changed after each execution.

## TODO
 - Do bug testing, there are most likely a lot of bugs left in the code.
 - Update old tests that are no longer valid.
 - at [src\controllers\tables\source\linkedin\fact\make_market_tool_date_table.mjs](src\controllers\tables\source\linkedin\fact\make_market_tool_date_table.mjs) differentiate between markets.
 - at [src\controllers\tables\fact\make_market_date_table.mjs](src\controllers\tables\source\linkedin\fact\make_market_date_table.mjs) differentiate between all markets because right know all markets get the same `amount_of_offers_attribute`.
 - at [src\controllers\tables\source\github\fact\make_community_tool_date_table.mjs](src\controllers\tables\source\github\fact\make_community_tool_date_table.mjs) rank is temporarily NULL. Think about how to calculate a rank.
 - at [src\routes\scrapers\github-explore-scraper.mjs](src\routes\scrapers\github-explore-scraper.mjs) find out why sometimes headerInfo[i].type throws errors, it's a race condition. (Update: It may be fixed now, check pending.)
 - at [src\controllers\tables\source\github\fact\make_project_company_table.mjs](src\controllers\tables\source\github\fact\make_project_company_table.mjs) Use scraper instead, it's probably faster than doing many api requests.
 - at [src\routes\scrapers\google-trends-scraper.mjs](src\routes\scrapers\google-trends-scraper.mjs) find out how to make it faster, for 20000 searches at 3 seconds per search it takes 111 minutes for completion.
